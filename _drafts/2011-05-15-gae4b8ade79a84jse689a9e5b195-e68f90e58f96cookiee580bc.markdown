---
author: cloga0216
comments: true
date: 2011-05-15 16:00:47+00:00
layout: post
slug: ga%e4%b8%ad%e7%9a%84js%e6%89%a9%e5%b1%95-%e6%8f%90%e5%8f%96cookie%e5%80%bc
title: GA中的JS扩展-提取cookie值
wordpress_id: 1076
categories:
- GA的JS扩展
tags:
- cookie
---

GA利用__umaz cookie为我们提供每次访问来源的记录，其实这些信息，我们可以应用于其他的程序中，例如，我们自己的购物车系统，CRM系统等等。这里为大家介绍一个提取cookie值的利器，来自urchin.js（旧版的ga.js）中的_uGC方法。

先上code：

_function _uGC(l,n,s) {
if (!l || l=="" || !n || n=="" || !s || s=="") return "-";
var i,i2,i3,c="-";
i=l.indexOf(n);
i3=n.indexOf("=")+1;
if (i > −1) {
i2=l.indexOf(s,i); if (i2 < 0) { i2=l.length; }
c=l.substring((i+i3),i2);
}
return c;
}_

这个方法中的作用是从某个字符串中提取某段字符串，有三个参数：

l：目标字符串

n：开始的模式

s：结束的模式

通过这个方法，可以很方便的提取任意cookie值，当然对于其他字符串提取也是适用的。我们知道cookie都是以名值对的方式出现，每个cookie之间以";"分隔。因此，如果我们想要提取__utmz cookie的值，那我们只需要这样：_uGC(document.cookie,"__utmz",";")。我们也知道在__utmz cookie中，来源存储在utmcsr参数中，媒介存储在utmcmd参数中，关键词（或路径）存储在utmctr参数中，content存储在utmcct参数中，广告系列存储在utmccn。并且这几个参数之间通过"|"分隔。因此，我们可以通过下面的方法提取这些参数的值。

var utmz=_uGC(document.cookie,"__utmz=",";");
source=_uGC(utmz,"utmcsr=","|");
meidum=_uGC(utmz,"utmcmd=","|");
term=_uGC(utmz,"utmctr=","|");
content=_uGC(utmz,"utmcct=","|");
campaign=_uGC(utmz,"utmccn=","|");

提取到这些值之后，你可以应用这些值导入到自己的系统中，利用用来标识一个订单的来源，或者客户的来源。或者也可以像我一样做一些无聊的事，比如显示你这次的访问来源：
