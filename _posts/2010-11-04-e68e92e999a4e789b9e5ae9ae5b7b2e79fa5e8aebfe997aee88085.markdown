---
author: cloga0216
comments: true
date: 2010-11-04 14:06:36+00:00
layout: post
slug: '%e6%8e%92%e9%99%a4%e7%89%b9%e5%ae%9a%e5%b7%b2%e7%9f%a5%e8%ae%bf%e9%97%ae%e8%80%85'
title: 排除特定已知访问者
wordpress_id: 673
tags:
- 过滤器
---

排除你的员工、搜索营销代理商或任何已知的第三方，比如你的网站开发者访问，是创建你的配置文件时的重要一步。这些访问者产生了数量相对较大的综合浏览量，这将极大的影响关键指标，比如你的转化率。
例如，将浏览器的首页设置为公司网站的员工在每次打开他们的浏览器时，将在报告中显示为返回访问者——并且极可能是一个单页的访问者。请记住GATC能突破任何缓存，因此，在潜在客户中配出这些员工是很重要的。同样的，网站开发人员为了问题排查的目的频繁的测试支付系统。这些访问也将触发GATC页面请求，并且极可能是你的目标转化页面。因此，你应该从你的报告中排除这些访问。
如果访问者通过固定IP地址连接互联网，那么排除这些已知访问者是非常简单的。如果是这种情况的话，从过滤器管理器中，选择预定义过滤器中排除来自相应IP地址的流量,图8.15a。

<!-- more -->


[![](http://www.cloga.info/wp-content/uploads/2010/11/8-15a.png)](http://www.cloga.info/wp-content/uploads/2010/11/8-15a.png)图8.15a  排除一个IP地址的访问者
 [![](http://www.cloga.info/wp-content/uploads/2010/11/8-15b.png)](http://www.cloga.info/wp-content/uploads/2010/11/8-15b.png)图8.15b  排除一个IP段的访问者




图8.15所示的例子适用于单个IP地址或者你有几个IP地址需要排除时（这种情况下设置多个排除过滤器）。但是，对于一个IP段，请使用带有正则式的自定义过滤器。例如，排除IP段63.212.171.1-64，如图8.15b所示的自定义过滤器：^63.212.171.([1-9]|[1-5][0-9]|6[0-4])$。正则表达式的概述请见附录A。
**如果访问者没有固定IP地址应该怎么办？
**往往家庭用户就是这个情况，家庭用户每次连接互联网时是互联网服务提供商（ISP）会分配不同的IP地址；在一个连接session中也可能发生这种情况。其解决方法是将_setVar()函数与自定义排除过滤器结合起来。其原理是指导已知的你想要排除的访问者访问一个隐藏的页面（常规访问者不会使用），这个页面上的Google Analytics中包含一个JavaScript标签。这个标签在访问者电脑上存储为持续的cookie，并且构成他们页面浏览数据的一部分。然后，使用排除过滤器来去除包含这一标签的页面浏览数据。
为访问者分配一个自定义标签，在你的隐藏GATC中调用_setVar()函数，如下所示：
`<script type=”text/javascript”>
var gaJsHost = ((“https:” == document.location.protocol) ? “https://ssl.” :
“http://www.”);
document.write(“<script src=’” + gaJsHost + “google-analytics.com/ga.js’
type=’text/javascript’></script>” );
</script>
<script type=”text/javascript”>
try{
var pageTracker = _gat._getTracker(“UA-12345-1”);
pageTracker._trackPageview();
**pageTracker._setVar(“dynamic”);
**}catch(err) {}</script>
`（GA已放弃了setVar函数，但是貌似现在这个函数还是可用的，未测，不做评论。）
用这种方法，只有访问了www.cloga.info/hiddenpage.htm的访问者被标记了，直到cookie过期（24个月）——假设这个cookie没有被改写或删除。请注意，在这个例子中，调用了_setVar()，并且设置了dynamic标签。但是，在括号中可以使用任何值。因为动态IP的访问者的每一次页面浏览都被标记了，图8.16显示了从你的配置文件中排除这些访问所需要的过滤器。_setVar()的值存储在Google Analytics中标记为用户定义的字段中。 




![](http://www.cloga.info/wp-content/uploads/2010/11/8-16.png)图8.16  排除标记的访问者




**警告：**Google Analytics的_setVar()的使用已经被新的自定义变量功能所取代。但是，在本书写作时，还不能用任何自定义变量来过滤。因此，_setVar()仍有价值。自定义变量功能将在第9章“标记访问者、Session和页面”中详细讨论。
