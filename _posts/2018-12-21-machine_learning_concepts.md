---
title: "机器学习概念"
author: "cloga"
comments: yes
layout: post
slug: machine_learning_concepts
tags:
- machine learning
- 他山之石
categories: machine learning
---

机器学习（ML）可以帮助你使用历史数据来作出更好的商业决策。机器学习算法发现数据中的模式，并且用这些发现构建数学模型。你可以用这些模型对未来的数据进行预测。例如，一个机器学习模型的可能应用可以根据消费者历史的行为预测他购买特定商品的可能性。

## 使用机器学习解决商业问题

你可以在带有真实答案的已有样例的问题上应用机器学习。例如，如果你想使用机器学习来预测一封email是否是垃圾邮件，你可以收集被正确标记为垃圾邮件或非垃圾邮件的样例。接下来你可以使用机器学习在这些email样例上进行归纳，以便预测新email是不是垃圾邮件。这种从带有标记的真实答案的数据上进行学习的方法被称为监督式机器学习。

你可以在这些特定的机器学习任务上使用监督式机器学习：二分类（从两个潜在结果中预测一个），多分类（从两个以上的结果中预测一个）以及回归（预测一个数值）。

二分类问题里的例子有：

- 客户会不会买这个产品？
- 这封邮件是不是垃圾邮件？
- 这个产品是书还是农产品？
- 这个评论是消费者写的还是机器人？

多分类问题的例子有：

- 这个产品是书、电影还是衣服？
- 这个电影是浪漫戏剧、纪录片或惊悚片？
- 这个消费者最关系哪类产品？

回归问题的例子有：

- 明天北京的天气是多少？
- 这个产品的未来销量是多少？
- 这个消费者在多少天后停止使用这个应用？
- 这个房子值多少钱？

## 什么时候用机器学习

牢记机器学习不是适用于所有问题的解决方案，这很重要。在许多情况下，不需要使用机器学习技术就可以创建强健的解决方案。例如，如果你可以通过简单的规则、计算来决定目标值，或者预先定义的步骤可以被程序化，而不需要任何数据驱动的学习，那么你不需要机器学习。

在以下场景使用机器学习：

- *无法编码规则*：需要人类任务（例如识别一个email是不是垃圾邮件）不能使用简单的（决定主义）、基于规则的解决方案很好的解决。大量的因素会影响答案。当规则依赖太多的因素并且许多规则重叠或需要精细的调节时，很快就会变得很难由人类来准确编码规则。你可以使用机器学习来有效的解决这个问题。
- *无法扩展*：人工识别几百个email判断是不是垃圾邮件是可行的。但是，当面对几百万email时，这个任务就变得单调乏味了。机器学习方案可以有效的处理大规模的任务。

## 构建一个机器学习应用

构建一个机器学习应用是一个包含一系列步骤的迭代过程。要构建一个机器学习应用，遵循下列通用的步骤：

1. 以观察到什么和你想要模型预测什么答案来解构核心的机器学习问题
2. 收集、清理准备数据，以便使数据适于机器模型训练算法来消费。对数据进行可视化和分析，进行健康检查来判断数据质量和理解数据。
3. 通常，原始数据（输入变量）和答案（目标）都不是用可以用于训练高预测性模型的方式来表征。因此，你通常应该从原始变量中尝试构建更有预测性的输入表征或特征。
4. 将产生的特征喂给学习算法来构建模型，并且用构建模型以外的保留数据来评估模型的质量。
5. 使用模型对新数据实例来产生目标答案的预测。

### 表征问题

机器学习的第一步是决定你要预测什么，这被称为标签或者目标答案。想象这个场景，你想要生产产品，但是你决定根据每个产品的潜在销量来制造每个产品。在这个场景下，你想要预测每个产品将被购买多少次（预测销量）。使用机器学习来定义这个问题可以有多种方式。选择如何定义这个问题，取决于你的用例或者商业需求。

你是想要预测消费者将要在每个产品上购买的次数（这个场景下，目标是数值型的，你正在求解一个回归问题）？或者你是想要预测哪个产品将获得10个以上的购买（这个场景下，目标是二分的，你正在求解一个二分类问题）？

避免过于复杂化问题这很重要，用最简单的方法来满足你的需求。但是，避免丢失信息也很重套，特别是在历史答案中的信息。这里，将过去的实际销量转换为二分变量“大于10” VS “小于10”可能丢失有价值的信息。花费时间来决定那个目标对你的预测最敏感，将避免你构建一个不能回答问题的模型。

### 收集标记的数据

机器学习问题始于数据--最好是，已经知道目标答案的很多数据（例子或者观察）。已经知道目标答案的数据被称为*带有标记的数据*。在有监督机器学习中，算法从我们提供的标记样例中进行自我学习。

数据中的每个样例/观察必须包含两个元素：

- 目标 - 你想要预测的答案。你为机器学习算法提供被标记为带有目标的数据（正确答案）来进行学习。接下来，使用训练的机器学习模型来在你并不知道答案的数据上预测这个答案。
- 变量/特征 - 样本的属性，可以用于识别可以预测目标值的模式。

例如，对于email分类问题，目标是个标记email是否是垃圾邮件的标签。变量的例子是email的发送者、email的文本正文、文件的主题行、email的发送时间以及发信人与收信人之前是否有书信往来。

通常，数据不是方便的以标记的方式来获得。收集和准备变量和目标通常是解决机器学习问题的最重要步骤。样本数据应该是你将要使用模型来作出预测的数据的典型代表。例如，如果你想要预测email是不是垃圾邮件，你需要同时收集正例（垃圾邮件）和负例（非垃圾邮件），以便机器学习算法可以找到区分两类email的模式。

当你有了标记的数据，你需要将它转换为算法或者软件可以接受的格式。例如，你可能需要将数据转换为CSV格式，每个样本构成CSV文件的一行，每一类包含一个输入变量，其中一类包含目标答案。

### 分析数据

在将数据丢给机器学习算法前，良好的习惯是检查一下数据来识别问题并且获得对于正在使用的数据的见解。模型的预测力将会和你喂给他的数据一样好。

当分析数据时，需要将以下观点记在脑中：

- 变量和目标数据总览 - 理解变量的值以及哪些值在数据占支配地位很重要。你可以和一个与要研究问题利益相关的专家一起来进行数据总览。问一下你自己或者利益相关的专家：数据符合期望吗？是否看起来有数据收集问题？是否目标的一个类别比其他类别多很多？是否缺失值或无效数据多于预期？
- 变量-目标的相关 - 了解每个变量与目标类别的相关是很有用的，因为高相关意味着变量和目标类别之间有关系。通常来说，你想要包含有高相关的变量，因为，他们有高预测力（信号），不包含那些低相关的变量，因为他们可能低相关。

### 特征工程（处理）

通过数据总览和可视化了解数据之后，你会想要进一步转换你的变量让他们更有意义。这被称为*特征处理*。例如，假如有一些变量捕捉到事件发生的日期和事件。这个日期和时间不会再次出现，因为对于预测目标不会有任何帮助。因此，如果这个变量被转化为代表一天中的小时，星期以及月份等特征，如果这些事件倾向于在特定小时，星期或者月份发生，那么这些变量将会非常有用。这种构成更泛化的数据点来进行学习的特征处理可以为预测模型提供显著的改善。

通用特征处理的其他例子：

- 用更有意义的值（例如，你知道缺失的产品类别变量其实是书，那么你可以将所有产品类别中的缺失值替换为书）替换缺失或者无效的数据。增补缺失值的常见策略是将缺失值替换为平均数或中位数。选择替换缺失值的策略前，理解你的数据很重要。
- 构造一个特征与另一个特征的笛卡尔积。例如，如果你有两个变量，例如人口密度（城市、郊区、农村）和省份（北京、上海、广州），那么由这两个变量的笛卡尔积构成的特征中很可能有有用的信息（城市\_北京，郊区\_北京，农村\_北京，城市\_上海，郊区\_上海，农村\_上海，城市\_广州，郊区\_广州，农村\_广州）。
- 非线性变换例如将数值型变量分箱到类别中。在许多情况下，数值特征与变量的关系不是线性的（特征值与目标数值不是单调递增或者单调递减）。这种情况下，有效的方式是将数值特征分箱为代表不同数值特征范围的类别特征。每个类别特征（箱）可以接下来各自独自与目标进行线性关系的建模。例如，假如你知道连续的数值特征年龄与买书的可能性不是线性的。你可以将年龄分箱成类别特征，这可能更准确捕捉与目标的关系。数值变量的最佳分箱数取决于变量的特征以及它与目标的关系，最好通过实验来判断。
- 领域相关的特征（即，长宽高是独立的变量，你可以创建一个新变量：体积，其值为这三个变量的乘积）。
- 变量相关的特征。一些变量类型例如文本特征，这些特征可以捕捉网页结构，或句子的结构有通用的处理方式来帮助抽取结构或背景。例如，从“the fox jumped over the fence”文本中构建n-grams可以被表征为*unigrams*：the，fox，jumped，over，fence或*bigrams*：the fox，fox jumped，jumped over，over the，the fence。

包含更相关的特征有助于改进预测能力。很明显，不可能常常预先知道哪些特征有“信号”或预测影响力。因此，最好是包含可能对目标标签有可能相关的所有特征，并且让模型训练算法挑选最相关的特征。

## 数据拆分为训练和评估数据

机器学习的基本目标是对用于训练模型的数据实例进行归纳推理。我们想要评估一下模型在没有训练过的数据上的模式泛化质量。但是，因为未来的实例的目标值是未知的，我们此时无法检查我们在未来实例上预测准确性，我们需要使用一些我们已知答案的数据作为未来数据的代表。用训练的数据来评估模型是没用的，因为，这是奖励模型可以“记住”训练数据，而不是对训练数据进行推理。