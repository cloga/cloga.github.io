
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="ujianVerification" content="fbba4ee9b28ec33f11f17698ddc55b92" />
    <link rel="stylesheet" href="/pygments.css">
    <title>Google Tag Manger的几个应用实例</title>
    
    <meta name="author" content="Cloga Chen">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/assets/themes/bootstrap/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  
    <!--[if lt IE 9]>
      <script src="/assets/themes/bootstrap/resources/respond/Respond.min.js"></script>
    <![endif]-->

    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
    <script>
      dataLayer = [];
    </script>
  </head>

  <body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Cloga的互联网笔记</a>
        </div>

        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="nav navbar-nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



          <li><a href="/about.html">关于Cloga</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      
<div class="page-header">
  <h1>Google Tag Manger的几个应用实例 </h1>
</div>
<div class="row post-full">
  <div class="col-md-12">
    <div class="date">
      <span>13 December 2014</span>
    </div>
    <div class="content">
      <h1>Google Tag Manager简介</h1>

<p><a href="https://www.google.com.hk/tagmanager/">Google Tag Manager</a>是Google提供的一个代码管理工具，准确的说其实在页面上提供了一个容器，在这个容器中可以放置任意的HTML及JS代码。</p>

<p>可跟踪可量化是Digital Marketing的优势之一，随着而来的问题是需要在很多不同的页面上放置不同Vendor提供的监测代码，网站上要添加网站分析代码，转化页面需要添加Adwords转化代码或其他的Ad Network的转化代码，不同的代码有效期也可能不一致。代码管理工具应运而生，通过代码管理工具，网站分析师或者Digital营销人员可以自己管理页面上的代码，而不用每次都“劳烦”网站管理员。通过代码管理器可以有效的保证监测代码的一致性，也加快了响应速度。</p>

<p>其实Google在这个领域也只是一个追随者，凭借免费及巨大的用户规模而使Google Tag Manager更广泛的被大家所了解。简单做一下市场调查的话，会发现市场上其实有许多类似的产品：</p>

<ul>
<li><a href="https://dtm.adobe.com/">Dynamic Tag Management</a>：Adobe的代码管理器</li>
<li><a href="http://www.signal.co/products/tag/">Universal Tag Management System</a>：Signal的产品</li>
<li><a href="http://www.qubitproducts.com/tag-management">Open Tag</a>：Qubit的代码管理器，应该是这个领域里面比较早的产品，同时他们还有A/B Test的产品</li>
<li><a href="http://web.tagmanager.cn/">代码管家</a>：本地化的代码管理工具</li>
</ul>

<h1>Google Tag Manager的组成元素</h1>

<p>GTM在近期更新了UI 2.0，这里的名称以2.0的为准。</p>

<h4>Account（账户）</h4>

<p>一个GTM账号可以创建多个容器。</p>

<h4>Container（容器）</h4>

<p>每个容器对应于一个网站，一个容器对应一段GTM的代码。一个容器中可以包含若干代码。</p>

<h4>Tag（代码）</h4>

<p>一个代码对应于一种监测代码。代码比如指定在特定的条件下（触发器）触发。</p>

<h4>Trigger | Rule（触发器）</h4>

<p>触发器是代码的触发条件。触发器可以设定多种条件，比如URL，自定义事件，Dom元素等</p>

<h4>Variable | Macro（变量）</h4>

<p>GTM可以从Dom元素，URL及数据层获取一些变量，并将这些变量作为参数在Tag中使用</p>

<h1>Google Tag Manager的真实应用实例</h1>

<h4>UA基本监测代码的部署</h4>

<ul>
<li><p>代码
基本的UA Pageview代码，在代码的类型中选择UA，填写对应的Tracking ID即可</p></li>
<li><p>触发器
默认提供的所有页面触发器，其本质是一个可以匹配所有URL的触发器，.*正则式是匹配所有字符的意思</p></li>
</ul>

<h4>监测点击事件</h4>

<p>GTM内部会对页面的点击事件进行监听，我们可以在触发器中使用这些事件来达到监测特定点击事件的目的。</p>

<p>下面用一个实例在具体说明一下，如下:</p>

<p><img src="http://cloga.info/files/reg_login.png" alt="reg_login.png"></p>

<p>在这个页面的右上有登陆和注册的链接，如果想要监测注册链接，在没有使用GTM时，我们需要改动对应页面的元素，在上面添加onclick事件，并在其中调用对应的GA方法。如下图所示：</p>

<p><img src="http://cloga.info/files/manul_onclick.png" alt="manul_onclick.png"></p>

<p>使用了GTM之后，我们不需要技术同事在原始的HTML页面上添加对应的代码，具体的做法如下：</p>

<ul>
<li>代码
首先要新加一个代码，监听所有的点击事件</li>
</ul>

<p><img src="http://cloga.info/files/click_listener.png" alt="click_listener.png"></p>

<p>触发条件为所有页面</p>

<p>接下来要定义点击了这个链接应该触发的GA代码，我在这里选择了事件监测。</p>

<p><img src="http://cloga.info/files/event_config.png" alt="event_config.png"></p>

<ul>
<li>触发器
先来捕捉右上注册点击事件</li>
</ul>

<p><img src="http://cloga.info/files/reg_right_top_trigger.png" alt="reg_right_top_trigger.png"></p>

<p>第一个条件是触发了Click事件，第二个条件是这个事件发生的Dom元素的类包含navi_login_name navi_hover_bg。结合起来的触发条件就是在在类包含navi_login_name navi_hover_bg的元素上发生Click事件。</p>

<p>GTM提供了许多的element的属性可以作为条件，比如id，url，text，classes都可以作为触发器的条件，也可以多个属性结合在一起。</p>

<p><img src="http://cloga.info/files/element_conditions.png" alt="element_conditions.png"></p>

<h1>Google Tag Manager测试</h1>

<p>加好了代码之后接下来就要进行测试并发布，GTM提供了完整的测试和发布流程，首先点击preview&gt;debug，进入测试模式</p>

<p><img src="http://cloga.info/files/gtm_debug.png" alt="gtm_debug.png"></p>

<p>进入debug模式后在页面下方会出现GTM的debug窗口，当前页面上触发的代码都有提示。</p>

<p><img src="http://cloga.info/files/gtm_debug1.png" alt="gtm_debug1"></p>

<p>如图所示，基本的GA代码已经触发了。</p>

<p>点击一下右上的注册链接，看一下效果</p>

<p><img src="http://cloga.info/files/gtm_debug2.png" alt="gtm_debug2"></p>

<p>可以看到我们新建的右上注册butoon点击已经触发了</p>

<p>在选中这个点击事件时，点击一下debug窗口中的宏看一下：</p>

<p><img src="http://cloga.info/files/gtm_debug3.png" alt="gtm_debug3"></p>

<p>啊哈，里面显示了一个事件对应的所有属性，通过这个页面可以很方便的了解定位这个事件的参数。</p>

<h1>Google Tag Manager发布</h1>

<p>最后，不要忘记发布当前的代码。</p>

    </div>

    
      <ul class="tag_box inline">
        <li><i class="icon-folder-open"></i></li>
        
        


  
     
    	<li><a href="/categories.html#google tag manager-ref">
    		google tag manager <span>1</span>
    	</a></li>
    
  


      </ul>
    

    
      <ul class="tag_box inline">
        <li><i class="icon-tags"></i></li>
        
        


  
     
    	<li><a href="/tags.html#Google Tag Manager-ref">Google Tag Manager <span>1</span></a></li>
    
  



      </ul>
    

    <hr>
    
    <ul class="pagination">
      
        <li class="prev"><a href="/python/2014/10/21/build_a_simple_python_app_on_heroku" title="在Heroku上搭建简单的Python Web 应用">&larr; 上一页</a></li>
      
        <li><a href="/archive.html">归档列表</a></li>
      
        <li class="next"><a href="/python_scientific_lecture_notes/2014/12/14/python_scientific_lecture_notes_cn" title="Python科学讲座笔记目录">下一页 &rarr;</a></li>
      
    </ul>
    <hr>
    <!-- Paste the 3 next lines where you want the sharing button(s) to appear -->
    <div class="post-sharing">
     


  <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
	<span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_tools_1"></a>
	<a class="jiathis_button_tools_2"></a>
	<a class="jiathis_button_tools_3"></a>
	<a class="jiathis_button_tools_4"></a>
	<a href="http://www.jiathis.com/share?uid=1654363" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1343300786690926" charset="utf-8"></script>
<!-- JiaThis Button END -->



    </div>    
    <div class="post-comments">
    


  <!-- UJian Button BEGIN -->
<div class="ujian-hook"></div>
<script type="text/javascript">var ujian_config = {num:12,picSize:84,textHeight:45};</script>
<script type="text/javascript" src="http://v1.ujian.cc/code/ujian.js?uid=1654363"></script>
<a href="http://www.ujian.cc" style="border:0;"><img src="http://img.ujian.cc/pixel.png" alt="友荐云推荐" style="border:0;padding:0;margin:0;" /></a>
<!-- UJian Button END -->
<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1654363"></script>
<!-- UY END -->



    </div>
  </div>
</div>


      <hr>
      <footer>
        <p>
          &copy; 2014 Cloga Chen
          <span class="pull-right text-muted">
            powered by
            <a href="http://jekyll-bootstrap-3.github.io" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll-Bootstrap-3</a>
            and <a href="http://getbootstrap.com" target="_blank">Twitter Bootstrap 3.0.3</a>
          </span>
        </p>
      </footer>
    </div>

    
    <script src="/assets/themes/bootstrap/resources/jquery/jquery.min.js"></script>
    <script src="/assets/themes/bootstrap/resources/bootstrap/js/bootstrap.min.js"></script>
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-7VF4"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-7VF4');</script>
<!-- End Google Tag Manager -->


  </body>
</html>

